## SOHO

* DHCP: 유동 ip를 사용할떄 서버가 ip를 할당해줌
* NAT: 주소 변환
    * 공인 IP -> 사설 IP 또는 사설IP -> 공인 IP
    * SNAT, DNAT
    * 경비절약, 보안측면

* Default 사설 IP 꼭 암기하기
    1. A Class
    2. B Class
    3. C Class

## PAT (Port Address Translation)

* NAT 안에 포함되어 있는 기술
    * 송신지 IP와 **송신지 PORT 번호**도 같이 바뀌는 것

## Port Forwarding

* ip와 포트를 일대일 매핑?

## 보안솔루션

### 보안망 구성도

* 방화벽과 연결된 망
    1. 인터넷 (Untrust Zone)
        * 라우터에 연결되어 있고 통신사 외부망으로 연결된 곳
    2. DMZ (Public / Service Zone)
        * 대표적으로 웹서버
            * 내부와 외부 사람들이 모두 접속 가능
        * 보안성을 높이기 위해 여러 개 구성 가능
    3. Intranet (Private / Trust Zone)
        * 내부 직원에 연결
    4. Extranet
        * 회사 대 회사의 서비스 연동
* DNS 서버
    * DMZ에 있는 서버 -> 외부 서비스용
    * Intranet -> 내부 직원용

## 방화벽

* 접근 제어 (Acesss Control)
    * 패킷 필터링
        * 목록에 없는 학생 차단!
    * 접근 제어 룰을 만들어야 함, 방화벽 관리자가
* NAT
* 액세스 기록 기능
* 사용자 인증
* 암호화 + 터널링

### 방화벽 정책 설정

* 내부 -> 외부
    * 제일 관대한 정책
* 외부 -> 내부
    * 제일 여러운 정책

### 방화벽 세팅

* 차단 ip와 포트를 알아야 세팅 가능

### 방화벽 한계

* Rule Set에 없는 공격은 막을 수 없다
* 방화벽을 경유하지 않는 공격은 막을 수 없음
    * 라우팅 정책이 잘못된 것임
* DOS, DDOS 공격을 막을 수없음
    * 열린 포트에 대한 공격을 막을 수 없다
* 데이터에 실려 있는 악성코드나 바이러스를 막을 수 없음
* 내부 네트워크에 존재하는 공격을 막을 수 없음
    * DLP를 사용 -> 프린트, USB 복사 LOCK 시킴
        * Data Loss Prevention

### 침입 탐지 시스템 (IDS, Intrusion Detection System)

* 침입자를 찾아내는 보안 시스템
    * 방화벽의 한계때문에 나옴'
* HIDS (Host-based Intrusion Detection System)
    * 특정 서버에 설치해서 공격을 찾아내는 것
        * 9/28의 해쉬값 9/29의 해시값 비교 -> 무결성 점검
* NIDS (Network Intrusion Detection System)
    * 스위치를 통해 오가는 모든 트래픽을 받아서 공격자 유형을 탐지

## HIDS

* 서버에 직접 설치되어 네트워크와 무관
* 호스트의 자원 사용 실태, 로그 등을 분석하여 침입 여부 탐지
* 무결성 체크 기능이 주요 기능
    * 초기 DB의 해시값 저장
    * 해시값 변조 유무 결과 보고
* 오픈 소스 IDS: Tripwire

## NIDS

* 네트워크 상에서 일어나는 침입 시도를 탐지
* 스니핑 환경이 구성되어 있어야 함
    * 포트 미러링, 탭, 허빙 등
* 오픈 소스 NIDS : Snort

### NIDS 구축 방법

1. Detection Rule 만들기
    * 비수강생 찾기: 마우스를 계속 클릭하고, 잠을 자는 학생 -> 룰로 만들기 
    * 비수강생을 찾아도 탐지만 할 수 있지 제거를 할 수 없다 

## Snort Rule (시그니처 기반 탐지, 오용탐지)

* 공격 패턴 감지
    * 시그니처: 공격 패턴
        * 패킷 분석기로
* 공격 탐지 룰 생성
    * 요즘은 7계층 기반의 악성코드 공격이 많아서 룰 만들기 어려움
* 공격자 탐지
* 알림, 차단
* IDS -> 침해대응팀 (대응방안모색)

## False Negative & False Positive

* 미탐지 (False Negative)
    * 신규 공격은 탐지하기 어려움

* 오탐지 (False Positive)
    * 오탐률은 낮음 RULE을 만들어 있기 
    
## IDS 탐지 방법

* 오용탐지 (Misuse Detection)
    * 시그니처 기반의 탐지
    * 알려진 공격법 패턴을 탐지
* 이상탐지 (Anomaly Detection)
    * 정상 범위를 벗어나는 데이터 탐색
        * 통계적 분석을 사용
* 예시
    * 로그인 실패 -> 오용탐지
    * 로그인 몇 번 실패 -> 이상탐지


## IDS 탐지 비교

* 오용탐지
    * 오탐률 낮음
        * 기존의 시그니처 사용
    * 미탐률 높음
        * 새로운 공격에 대한 패턴이 없으므로
* 이상탐지
    * 패턴 업데이트 불필요
        * 인공지능 알고리즘이 스스로 판단
        * 알려지지 않는 새로운 공격 탐지 가능
    * 오탐률이 높음
        * 틀릴 가능성이 높다!
* 오용탐지, 이상탐지 구분 잘 하기!!

## 침입 탐지 시스템 한계

* 실시간 공격은 막기 힘듦
* 단편화, 난독화, 암호화와 같은 기술은 감지하기 어려움
    * 패턴을 감지하기 어려움

### 정리

* 방화벽: 애플리케이션 공격 약해 (접근제어룰)
* IDS: 차단, 애플리케이션 공격 탐지 (탐지룰)
* IPS: 애플리케이션 공격 탐지 + 차단

### 침입 방지 시스템 (IPS)

* IDS 와 방화벽의 기능 결합
* 이상 행위 탐지
    * 알려지지 않은 공격 패턴에 대응
* 능동형 보안 솔루션
    * IDS 탐지후 조치 취하는 기술
    * IPS 탐지 전 조치?

## InLine 모드

* 물리적 네트워크 경로 상에 보안장비 설치
* 모든 트래픽들이 보안장비를 거쳐 가도록 하는 모드
* 패킷 차단 목적의 장비에 적용
    * 실시간 패킷을 탐지하고 차단

## Out of Path 모드

* 미러링 장비를 통해 복제된 패킷을 받아 탐지하는 모드
    * 복제된 패킷을 탐지하기 때문에 실시간 패킷은 차단하기 어려움

## WAF (Web Application Firewall)

## NAC (Network Access Control)

원격접속 제어

1. 정상적인 장치/사용자 인증 확인
2. 안티바이러스 설치 여부 점검
3. 보안패치 설치 여부 점검

## VPN
* 공영망을 개인망처럼 데이터를 전송할 수 있게 보안성을 높여준 기술
    * 암호화 기술을 사용
        * ESP Encapsulation

## 계층별 암호화 프로토콜

* 2계층: L2TP, PPTP 
* 3계층: IPSec
* 4계층: TLS
* 5계층: SSL
* 7계층: HTTPS, SSH etc

## Cisco ASA VPN

* Remote Access VPN: 1 대 그룹
    * 개인이 사용
        * 가볍게 SSL VPN 사용 -> 인증서 기반 암호화
* Site to Site VPN: 그룹 대 그룹
    * 기업이 사용
        * IPsec
            * 빡센 암호화 과정

### ESP Encapuslation

* Tunnel 모드 -> 전체 암호화
    * 헤더 정보가 가려져므로 새로운 IP Header 붙여야 함
* Transport 모드 -> 데이터만 암호화
* ESP 헤더가 추가됨 -> 그래서 캡슐화임
* 즉, VPN는 캡슐화로 암호화를 시킴

### UTM (Universal Threat Management)

* 다양한 보안 장비를 통합해서 제공하는 보안 솔루션