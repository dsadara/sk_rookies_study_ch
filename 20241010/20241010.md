# 인증처리 미흡 취약점

### 자바스크립트 우회 가능 여부
회원 가입 하는 과정에서 중요한 정보를 우회
* 서버에서 Response가 와서 브라우저에서 해석되는 것을 중간에 가로채서 우회하기
* 자바스크립트를 전달 받을 떄 프록시를 이용해서 이를 수정하면 해킹가능

### 8081 사이트 회원가입 뚫기
* 일단 사전지식
  * 주민번호를 적고 확인 버튼을 누르면
  * 인터셉트해도 잡히지 않음
    * 자바스크립트에서 주민번호를 검증하는 것
      * jumin1() 함수
* 주민번호 페이지 뚫는법
  1. 인터셉트 키고 페이지 리로딩
  2. 자바스크립트에서 주민번호 검증 로직 지우기
     * form.action(), form.submit()은 지우지 않기!
  3. 인터셉트 FORWARD
  4. 인터셉트 끄기
  5. 주민번호 적고 확인 누르기
* 회원번호 페이지 뚫기
  1. 인터셉트 키고 리로딩
  2. send() 함수에서 form.submit(), form.action() 빼고 검증 로직 지우기
  3. 인터셉트 포워드 후 오프
  4. 아무거나 적고 회원가입 누르면 성공!

### 8082 사이트 회원가입 뚫기
* 자바스크립트 함수 수정하기
  * searchZip() 
    * 우편번호 검색 중요하지 않아보임
  * JoinSendit()
    * 중요해보이는 함수
    * 방법
      * 주민번호 검증 로직만 삭제해도 됨
      * 검증 로직 다 삭제하려면
        * var form=document.joinForm;
        * form submit();
        * 이거두개만 남기면 됨

### 자바스크립트 우회 취약점 해결 방법
서버사이트 스크립트(PHP)에서 체크를 해주자!!

### 비밀글 접근하기
* 1대1게시판은 작성자와 운영자만이 볼 수 있음
  * queryparam의 id값을 바꿔주면 다른 사람거를 볼 수 있음
    * id:535 -> id:536으로 변경
      * 536번째 게시물 볼 수 있음
* 게시물 수정 페이지
  * POST 값은 비밀번호 체크
  * RESPONSE Form Input 할떄는 비밀번호 체크 X
    * FORM INPUT을 변경해주면 다른 사람 게시물에 들어갈 수 있다
* 수정 완료 페이지도 비밀번호 체크 X
  * POST 데이터를 열람 가능함
    * 비밀번호 조회 가능
    * 게시물 번호 수정하면 상대방 게시물 변경 가능
* 1대1 게시판과 테이블을 공유함
  * 1대1 게시판에서 자유게시판의 id를 쿼리 파라미터로 넣으면 접근 가능
* 덧글 삭제하기
  * 
  
## https://www.ransomware.live/

* OSINT 같은 것

## 8888 사이트 취약점 찾기
* 아이디:asd
* 비밀번호:8888

## 시큐어 코딩 사용자 인증
* 모든 페이지에서 세션 검증을 해야 함
* 관리자 페이지는 인증 처리도 해야 함

### 이상징후 탐지 (FDS)
* 해외에서 카드 결제를 하면 전화가 오는 것
  * 통계적으로 맞지 않으니까 탐지 하는 것

## XSS 취약점

클라이언트 스크립트를 이용하여 사용자에게 특정 행위를 하도록 만드는 취약점
  * Javascript, VBScript
  * 공격 유형
    * 세션 하이재킹 (세션 재사용 공격)
    * 악성코드 배포
    * 피싱 사이트 유도
  * OWSAP A3번임

### Stored XSS
* 악성 스크립트가 서버에 저장되어 다른 사용자의 브라우저를 제어하는 것

### 쿠키 정보 수집하기
1. 직접 서버를 구축하여 악성 서버로 사용
2. 호스팅 업체 서버를 빌려서 악성 서버로 사용
3. 이미 구축되어 있는 수집 서비스를 사용하는 방법

### Reflected XSS
요즘은 취약점이라고 분류하지는 않음

### bxxshunter
* https://bxsshunter.com/
* payload
  * 공격 코드 복사
* 게시물 작성해서 코드 복붙
* 누가 게시물 클릭하면 xss fired에 잡힘
  * 쿠키정보 php session id 복사하고
  * f12 눌러서 붙여넣고 새로고침
  * 클릭한 사람의 세션으로 로그인 됨
* 대응방안
  * html로 게시물을 작성하지 않게 하면 됨 ㅎ
    * text형식으로만 작성
    * 게시판이 심심해짐 이미지 업로드 어뜨케? 

## XSS 시나리오
* 사용자의 권한은 뭘로 획득하는게 좋을까?
  * 게시물, 쪽지보내기로 털기 좋음
* 관리자의 권한은?
  * 1대1문의, 상품문의, 결제내역
    * 상품문의, 결제내역은 입력값이 많으니깐
      * 입력창 모두에 스크립트를 넣어볼 수 있음
* 게시물 작성
  * 이메일, 제목, 내용에 스크립트 넣기
    * alert()
    * 게시물 클릭 어떤 것이 alert 뜨는지 확인해보기
  * 게시물 제목이 짤리면
    * 개발자 도구나 버프스위트로 게시물 수정해서 탈출

# 관리자페이지 실습
* beebox에서 실습
  * 두 세션으로 크로스 체크
    * 크롬: 사용자
    * 엣지: 관리자